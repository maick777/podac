import{e as o,c as L,o as N,a as x,w as p,aQ as v,ay as q,a0 as Q,n as A,r as V,f as R,g as U,s as W}from"./index-DhVY4AOr.js";import{u as B,d as M,e as z,a as D}from"./notifyHooks-DTCs8dSN.js";import{b as P}from"./PopupComponent-BMoTzUKP.js";const T={__name:"textComponent",props:{modelValue:{type:[String,Number],required:!0},label:{type:String,default:""},field:{type:String,default:""},class:{type:String,default:""},help:{type:String,default:""},type:{type:String,default:"text"},rules:{type:String,default:""}},emits:["update:modelValue"],setup(i,{emit:w}){const s=i,l=w;console.log("PROPS.....................................................",s);const g=o(()=>{const a=s.rules?s.rules.split("|"):[],r=[];a.includes("required")&&r.push(n=>!!n||"Este campo es obligatorio");const f=a.find(n=>n.startsWith("max"));if(f){const n=parseInt(f.split(":")[1],10);r.push(c=>c==null?!0:c.toString().length<=n||`Máximo ${n} caracteres`)}const h=a.find(n=>n.startsWith("min"));if(h){const n=parseInt(h.split(":")[1],10);r.push(c=>c==null?!0:c.toString().length<=n||`Máximo ${n} caracteres`)}return a.includes("alpha")&&r.push(n=>/^[A-Za-zÁáÉéÍíÓóÚúÜüÑñ\s]+$/.test(n)||"Solo letras"),a.includes("alphanumeric")&&r.push(n=>/^[A-Za-zÁáÉéÍíÓóÚúÜüÑñ0-9 ]+$/.test(n)||"Solo caracteres alfanuméricos"),r}),m=o(()=>{const a=s.rules?s.rules.split("|").find(r=>r.startsWith("max")):null;return a?parseInt(a.split(":")[1],10):255}),d=o(()=>{const a=s.rules?s.rules.split("|").find(r=>r.startsWith("min")):null;return a?parseInt(a.split(":")[1],10):null}),b=o(()=>s.rules?s.rules.includes("readonly"):!1),S=o(()=>s.rules?s.rules.includes("disable"):!1),y=o(()=>s.label&&s.rules?.includes("required")?`${s.label} *`:s.label);return(a,r)=>(N(),L("div",{class:A(["col-xs-12 col-sm-6",s.class])},[x(Q,q({"model-value":i.modelValue,label:y.value,type:i.type,name:i.field,id:i.field},a.$attrs,{rules:g.value,maxlength:m.value,minlength:d.value,disable:S.value,readonly:b.value,"onUpdate:modelValue":r[0]||(r[0]=f=>l("update:modelValue",f)),dense:""}),{before:p(()=>[v(a.$slots,"before")]),prepend:p(()=>[v(a.$slots,"prepend")]),append:p(()=>[v(a.$slots,"append")]),after:p(()=>[v(a.$slots,"after")]),_:3},16,["model-value","label","type","name","id","rules","maxlength","minlength","disable","readonly"])],2))}},Z={__name:"selectComponent",props:{modelValue:{type:[String,Number,null],required:!1},label:{type:String,default:""},field:{type:String,default:""},class:{type:String,default:""},help:{type:String,default:""},rules:{type:String,default:""},api:{type:String,default:""},dataenum:{type:String,default:""},datawhere:{type:String,default:""}},emits:["update:modelValue","btn_action"],setup(i,{emit:w}){const{errorNotify:s}=B(),l=i,g=w,m=V(l.rules.includes("integer")?null:""),d=V([]),b=V([]),S=V(!1),y=async()=>{try{if(l.dataenum)d.value=l.dataenum.split(";").map(e=>{const[t,u]=e.includes("|")?e.split("|"):[e,e];return{value:String(t?.trim()),label:u?.trim()}}).filter(e=>e.value&&e.label);else{let e=(l.datawhere||"").replace(/\s*=\s*/g,"=").trim(),t=e?`?where=${encodeURIComponent(e)}`:"";console.log(`/cbo/${l.api+t}`);const $=(await D(`/${l.api}/cbo`+t).list()).data;console.log($),d.value=$.map(I=>({value:String(I.id),label:I.name?.trim()})).filter(Boolean)}b.value=[...d.value],a()}catch(e){console.error("Error al obtener options:",e),s(`Error al obtener data: ${l.api} ......... ${e}`)}};R(()=>l.datawhere,()=>{y()});const a=()=>{m.value=d.value.find(e=>String(e.value)===String(l.modelValue))||null};R(()=>l.modelValue,a),R(()=>l.datawhere,()=>{y()});const r=e=>{if(!e||!e.value){g("update:modelValue",l.rules.includes("integer")?null:"");return}const t=e.value;l.rules.includes("integer")?g("update:modelValue",Number(t)):g("update:modelValue",String(t))},f=(e,t)=>{const u=e.toLowerCase();t(()=>{b.value=e===""?[...d.value]:d.value.filter($=>$.label.toLowerCase().includes(u))})},h=o(()=>{const e=l.rules?l.rules.split("|"):[],t=[];return e.includes("required")&&t.push(u=>!!u||"Este campo es obligatorio"),t}),n=o(()=>l.rules?.includes("readonly")),c=o(()=>l.rules?.includes("disable")),C=e=>{S.value=e&&!!m.value},E=o(()=>l.rules?.includes("required")?`${l.label} *`:l.label);return U(y),(e,t)=>(N(),L("div",{class:A(["col-xs-12 col-sm-6",l.class])},[x(P,q({modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=u=>m.value=u),label:E.value,options:b.value,name:i.field,id:i.field},e.$attrs,{rules:h.value,disable:c.value,readonly:n.value,clearable:S.value,"onUpdate:modelValue":r,onFilter:f,onFocus:t[1]||(t[1]=u=>C(!0)),onBlur:t[2]||(t[2]=u=>C(!1)),dense:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"400"}),{prepend:p(()=>[v(e.$slots,"prepend")]),"no-option":p(()=>[x(M,null,{default:p(()=>[x(z,{class:"text-grey"},{default:p(()=>t[3]||(t[3]=[W(" Sin resultados ")])),_:1,__:[3]})]),_:1})]),_:3},16,["modelValue","label","options","name","id","rules","disable","readonly","clearable"])],2))}};export{T as _,Z as a};
