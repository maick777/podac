import{r as n,e as I,f as N,g as Z,c as G,o as m,a as o,w as a,i as _,b as x,y as H,s as v,Z as P,t as f,k as r,n as J,j as A,Q as B,ac as V,F as W}from"./index-DhVY4AOr.js";import{u as X,a as q,c as Y,d as ee,e as ae,f as le,C as te,Q as w,b as oe}from"./notifyHooks-DTCs8dSN.js";import{Q as se}from"./QBtnDropdown-fPiSFeZG.js";import{Q as ne}from"./QExpansionItem-BpTg90Cf.js";import{Q as ie}from"./QPage-C9SVU1xd.js";import{_ as re,P as ce}from"./PopupComponent-BMoTzUKP.js";import ue from"./TareaDetalle-BZqwmF17.js";import{_ as de}from"./tareaFormComponent-CDAm9ADA.js";import{a as me}from"./selectComponent-DZrnU1wb.js";import{f as C}from"./formatDate-DzzFVTZi.js";import{u as fe}from"./vue-i18n.runtime-mEmbPDrt.js";import"./use-quasar-2VkCt5Th.js";import"./QSlideTransition-DTNjs9-t.js";import"./use-render-cache-7gfEi9oV.js";import"./QForm-mmGRrtT6.js";import"./textareaComponent-BbQtPJaR.js";import"./imageComponent-G_iIqQmX.js";const pe={class:"q-gutter-none q-mx-md"},_e=["onClick"],qe={__name:"TareaPage",setup(ve){const{t:s}=fe(),{errorNotify:Q}=X(),d=n(!1),D=q("tareas"),E=n("tareas"),p=n("insert"),b=n(!1),h=n(null),y=n("las la-plus-circle"),i=n(null),g=n(null),k=n(""),c={},$=n([]),F=I(()=>[{label:"",name:"prioridad",slot:"semaforo",hidden:!0,align:"center",width:"10"},{label:s("table.title"),name:"name",link:"id",slot:"acciones"},{label:s("table.supervisor"),name:"responsable"},{label:s("table.entity"),name:"categoria"},{label:s("table.start"),name:"fecha_inicio",align:"center"},{label:s("table.status"),name:"estado",align:"center"},{label:s("table.limit"),name:"fecha_limite",align:"center"},{label:s("table.end"),name:"fecha_fin",align:"center"}]),z=n(0),u=async()=>{try{d.value=!0,k.value!=""&&(c.search=k.value);const t=await D.list(c);$.value=t.data.map(e=>({...e,fecha_inicio:C(e.fecha_inicio),fecha_limite:C(e.fecha_limite),fecha_fin:C(e.fecha_fin)}))}catch(t){console.log("Error...",t),Q(t.message)}finally{d.value=!1}},L=async t=>{c.search=t.search.trim()??"",await u()};N(i,t=>{c.id_prioridad=t||null,u()}),N(g,t=>{c.id_estado=t||null,u()});const S=async()=>{i.value=null,g.value=null,k.value="",c.search="",c.id_prioridad=null,c.id_estado=null,z.value++,await u()},U=I(()=>!!i.value||!!g.value||k.value&&k.value.trim()!==""),T=n({button_add:!0,button_edit:!0,button_delete:!1,button_detail:!0,hidden_pagination:!1,button_pagination_custom:!0}),R=async t=>{p.value=t.action_type,h.value=t.actionId,y.value="las la-edit",await u()},j=async()=>{p.value="insert",y.value="las la-plus-circle",b.value=!0},K=async t=>{try{if(d.value=!0,!t)return Q("No existe el identificador"),!1;h.value=t,b.value=!0,p.value="update",y.value="las la-edit"}catch(e){console.log("Error...",e),await u(),Q(e.message)}finally{d.value=!1}},M=async t=>{try{const e={id:t};d.value=!0;const l=await q(`/${E.value}/copy`).post(e);b.value=!0,p.value="update",y.value="las la-edit",h.value=l.data.id,await u()}catch(e){Q(e.message)}finally{d.value=!1}};return Z(()=>{u()}),(t,e)=>(m(),G(W,null,[o(ie,{class:"q-pa-md"},{default:a(()=>[(m(),_(re,{title:"",key:z.value,columns:F.value,rows:$.value,default_action:T.value,onSearch:L},{header:a(()=>[o(B,{label:r(s)("button.add"),icon:"las la-plus-circle",color:"green",dense:"",outline:"",onClick:e[0]||(e[0]=l=>j())},null,8,["label"])]),header_right:a(()=>[U.value?(m(),_(B,{key:0,icon:"las la-undo-alt",class:"q-mx-sm",flat:"",round:"",size:"sm",onClick:e[1]||(e[1]=l=>S())},{default:a(()=>[o(w,{class:"bg-default",offset:[10,10],"transition-show":"scale","transition-hide":"scale"},{default:a(()=>[v(f(r(s)("button.clear_filter")),1)]),_:1})]),_:1})):x("",!0),o(me,{label:r(s)("form.status"),modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=l=>g.value=l),api:"estados_tarea",rules:"integer"},null,8,["label","modelValue"]),A("div",pe,[o(V,{"keep-color":"",modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value=l),"checked-icon":"check_circle","unchecked-icon":"circle",val:"2",color:"red",size:"xs",dense:""},{default:a(()=>[o(w,{class:"bg-red",offset:[10,10],"transition-show":"scale","transition-hide":"scale"},{default:a(()=>[v(f(r(s)("priority.high")),1)]),_:1})]),_:1},8,["modelValue"]),o(V,{"keep-color":"",modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value=l),"checked-icon":"check_circle","unchecked-icon":"circle",val:"3",color:"yellow",size:"xs",dense:""},{default:a(()=>[o(w,{class:"bg-yellow text-black",offset:[10,10],"transition-show":"scale","transition-hide":"scale"},{default:a(()=>[v(f(r(s)("priority.medium")),1)]),_:1})]),_:1},8,["modelValue"]),o(V,{"keep-color":"",modelValue:i.value,"onUpdate:modelValue":e[5]||(e[5]=l=>i.value=l),"checked-icon":"check_circle","unchecked-icon":"circle",val:"1",color:"green",size:"xs",dense:""},{default:a(()=>[o(w,{class:"bg-green",offset:[10,10],"transition-show":"scale","transition-hide":"scale"},{default:a(()=>[v(f(r(s)("priority.low")),1)]),_:1})]),_:1},8,["modelValue"])])]),id:a(({row:l})=>[A("a",{onClick:O=>K(l.id),class:"link_animate cursor-pointer"},f(l.name),9,_e)]),semaforo:a(({row:l})=>[l.prioridad?(m(),_(P,{key:0,name:"circle",color:l.color},{default:a(()=>[o(w,{class:J(`bg-${l.color}`),offset:[10,10],"transition-show":"scale","transition-hide":"scale"},{default:a(()=>[v(f(l.prioridad),1)]),_:2},1032,["class"])]),_:2},1032,["color"])):x("",!0)]),acciones:a(({row:l})=>[o(se,{color:"secondary",size:"sm",round:"",flat:"",dense:"","dropdown-icon":"las la-ellipsis-v","menu-anchor":"top right","menu-self":"top left","auto-close":!0},{default:a(()=>[o(Y,{class:"custon_list_before",dense:""},{default:a(()=>[H((m(),_(ee,{clickable:"",onClick:O=>M(l.id)},{default:a(()=>[o(ae,null,{default:a(()=>[o(le,null,{default:a(()=>[o(P,{name:"las la-copy",size:"sm",color:"primary"}),v(" "+f(r(s)("button.duplicate")),1)]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[te]])]),_:2},1024)]),_:2},1024)]),_:1},8,["columns","rows","default_action"])),b.value?(m(),_(ce,{key:0,title:r(s)("main.task"),icon:y.value,onClose:e[6]||(e[6]=l=>b.value=!1),size:"lg",maximized:!1},{default:a(()=>[o(de,{parent:h.value,parent_action:p.value,onFormAction:R},null,8,["parent","parent_action"]),p.value==="update"?(m(),_(ne,{key:0,dense:"","default-opened":"",label:r(s)("group"),icon:"las la-user-friends",class:"text-grey-9 q-mt-sm","header-class":"text-grey-6"},{default:a(()=>[o(ue,{parent:h.value},null,8,["parent"])]),_:1},8,["label"])):x("",!0)]),_:1},8,["title","icon"])):x("",!0)]),_:1}),o(oe,{showing:d.value,label:"Cargando...","label-class":"text-teal",color:"blue","label-style":"font-size: 1.1em"},null,8,["showing"])],64))}};export{qe as default};
