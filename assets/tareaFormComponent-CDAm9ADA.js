import{r as t,g as R,c as G,o as C,a,w as d,m as H,i as I,b as S,k as s,q as J,j as w,Q as $,s as K,t as O,l as P,F as W}from"./index-DhVY4AOr.js";import{u as X,Q as Y,b as Z,a as x}from"./notifyHooks-DTCs8dSN.js";import{Q as ee}from"./QForm-mmGRrtT6.js";import{_ as le,a as V}from"./selectComponent-DZrnU1wb.js";import{_ as ae}from"./textareaComponent-BbQtPJaR.js";import{u as te,_ as k,f as B,a as E}from"./formatDate-DzzFVTZi.js";import{u as oe}from"./vue-i18n.runtime-mEmbPDrt.js";const se={class:"row full-width items-center"},ue={class:"col-auto"},re={class:"col text-right"},pe={__name:"tareaFormComponent",props:{parent:{type:Number,required:!0,default:null},parent_action:{type:String,required:!0,default:""}},emits:["form-action"],setup(F,{emit:A}){const{t:o}=oe(),{successNotify:D,errorNotify:r}=X(),{showConfirmDelete:L}=te(),y=t("tareas"),n=t("insert"),q=t(!1),N=F,i=t(null);i.value=N.parent,N.parent_action&&(n.value=N.parent_action);const T=A,m=t(""),c=t(null),v=t(""),f=t(null),p=t(null),b=t(null),_=t(null),g=t(null),Q=t(null),U=t(null),h=async()=>{try{L(async()=>{await x(y.value).remove(i.value)})}catch(u){r(u.toString())}},j=async()=>{if(n.value=="update")try{if(!i.value)return r("No existe el identificador"),!1;const u=await x(y.value).getById(i.value),e=u.data;m.value=e.name,c.value=e.id_responsable,v.value=e.detalle,f.value=B(e.fecha_inicio),p.value=B(e.fecha_limite),b.value=e.id_categoria,_.value=e.id_prioridad,g.value=e.id_estado,Q.value=B(e.created_at),U.value=e.id_user_create,n.value="update",console.log("Success...",u)}catch(u){console.log("Error...",u),r(u.message)}else M()},z=async()=>{const u={name:m.value,id_responsable:c.value,detalle:v.value,fecha_inicio:E(f.value),fecha_limite:E(p.value),id_categoria:b.value,id_prioridad:_.value,id_estado:g.value};if(n.value=="update"){i.value||r("No existe el identificador");try{const e=await x(`${y.value}/${i.value}`).update(u);D(e.message)}catch(e){e.details?e.details.forEach(l=>{r(l)}):r(e.message)}}else if(n.value=="insert")try{q.value=!0;const e=await x(y.value).post(u);D(e.message),n.value="update",i.value=e.data.id;const l={action_type:n.value,actionId:i.value};T("form-action",l)}catch(e){e.details?e.details.forEach(l=>{r(l)}):r(e.message)}finally{q.value=!1}else r("Ninguna acciÃ³n seleccionada!")},M=async()=>{m.value="",c.value=null,v.value="",f.value=null,p.value=null,b.value=null,_.value=null,g.value=null};return R(()=>{j()}),(u,e)=>(C(),G(W,null,[a(P,{class:"q-mx-sm rounded-borders"},{default:d(()=>[a(ee,{onSubmit:z},{default:d(()=>[a(H,{class:"row q-col-gutter-x-lg"},{default:d(()=>[a(le,{label:s(o)("form.title"),modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),field:"name",rules:"max:50|required"},null,8,["label","modelValue"]),a(V,{label:s(o)("form.supervisor"),modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value=l),rules:"integer",api:"usuarios",class:"col-md-6 col-lg-6"},null,8,["label","modelValue"]),a(ae,{label:s(o)("form.detail"),modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=l=>v.value=l),rules:"max:700",class:"col-md-6 col-lg-6"},null,8,["label","modelValue"]),a(k,{label:s(o)("form.start"),modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value=l),rules:"required",class:"col-md-3 col-lg-3"},null,8,["label","modelValue"]),a(k,{label:s(o)("form.limit"),modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=l=>p.value=l),rules:"required",class:"col-md-3 col-lg-23"},null,8,["label","modelValue"]),a(V,{label:s(o)("form.entity"),modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=l=>b.value=l),rules:"integer|required",api:"tarea_categorias"},null,8,["label","modelValue"]),a(V,{label:s(o)("form.priority"),modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=l=>_.value=l),rules:"integer|required",api:"estados_prioridad"},null,8,["label","modelValue"]),n.value==="update"?(C(),I(V,{key:0,label:s(o)("form.status"),modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=l=>g.value=l),rules:"integer",api:"estados_tarea"},null,8,["label","modelValue"])):S("",!0),a(k,{label:s(o)("form.created_date"),modelValue:Q.value,"onUpdate:modelValue":e[8]||(e[8]=l=>Q.value=l),rules:"disabled",class:"col-md-3 col-lg-23"},null,8,["label","modelValue"]),a(V,{label:s(o)("form.created_user"),modelValue:U.value,"onUpdate:modelValue":e[9]||(e[9]=l=>U.value=l),rules:"integer|disabled",api:"usuarios"},null,8,["label","modelValue"])]),_:1}),a(J,{class:"q-pt-md"},{default:d(()=>[w("div",se,[e[11]||(e[11]=w("div",{class:"col"},null,-1)),w("div",ue,[a($,{label:s(o)("button.save"),type:"submit",color:"positive",icon:"las la-save",dense:"",outline:""},null,8,["label"])]),w("div",re,[n.value==="update"?(C(),I($,{key:0,label:"",color:"negative",icon:"las la-trash-alt",dense:"",flat:"",onClick:e[10]||(e[10]=l=>h())},{default:d(()=>[a(Y,{class:"bg-red",offset:[10,10],"transition-show":"scale","transition-hide":"scale"},{default:d(()=>[K(O(s(o)("button.delete")),1)]),_:1})]),_:1})):S("",!0)])])]),_:1})]),_:1})]),_:1}),a(Z,{showing:q.value,label:s(o)("loading"),"label-class":"text-teal",color:"blue","label-style":"font-size: 1.1em"},null,8,["showing","label"])],64))}};export{pe as _};
